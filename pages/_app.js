import '../styles/globals.css'
import "../assets/vendor/css/core.css";
import "../assets/css/demo.css";
import "../assets/vendor/css/theme-default.css";
import "../assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.css";
import "../assets/vendor/libs/apex-charts/apex-charts.css";
import "../assets/vendor/fonts/boxicons.css";
import Router from 'next/router';
import ProgressBar from "@badrap/bar-of-progress";
import Head from "next/head";
import { Inter } from "next/font/google";
import React, { useState, ReactElement } from "react";
import Image from "next/image";
import SideBar from "../components/SideBar";
import ProfilOption from "../components/ProfilOption";
import { BrowserRouter } from "react-router-dom";
import { AdminContext } from "../context/AdminContext";
import Context from '../context/AdminContext';

const progress = new ProgressBar({
  size: 4,
  color: "#6610f2",
  className: 'z-50',
  delay: 100,
});

Router.events.on('routeChangeStart', progress.start)
Router.events.on('routeChangeComplete', progress.finish);
Router.events.on('routeChangeError', progress.finish);

export default function App({ Component, pageProps }) {
  const [showProfile, setShowProfile] = useState(false);
  const [showSide, setShowSide] = useState(false);
  const [currentAdmin, setCurrentAdmin] = useState("");
  const handleClickprofile = () => {
    if (showProfile) {
      setShowProfile(false);
    } else {
      setShowProfile(true);
    }
  };

  const handleClickMenu = () => {
    if (showSide) {
      setShowSide(false);
    } else {
      setShowSide(true);
    }
  };

  if(Component.getLayout){
    return Component.getLayout(
      <Context>
        <Component {...pageProps} />
      </Context>
    );
  }
  
  return (
    <>
      <Context>
        <Head>
          <title>Jobs Next App</title>
          <meta name="description" content="Generated by create next app" />
          <meta name="viewport" content="width=device-width, initial-scale=1" />
          <link rel="icon" href="/favicon.ico" />
        </Head>
        <div class="layout-wrapper layout-content-navbar">
          <div class="layout-container">
            {<SideBar />}

            <div class="layout-page">
              <nav
                class="layout-navbar container-xxl navbar navbar-expand-xl navbar-detached align-items-center bg-navbar-theme z-0"
                id="layout-navbar"
              >
                <div
                  class="layout-menu-toggle navbar-nav align-items-xl-center me-3 me-xl-0 d-xl-none"
                  onClick={() => console.log("toto")}
                >
                  <a
                    class="nav-item nav-link px-0 me-xl-4"
                    href="javascript:void(0)"
                  >
                    <i class="bx bx-menu bx-sm"></i>
                  </a>
                </div>

                <div
                  class="navbar-nav-right d-flex align-items-center"
                  id="navbar-collapse"
                >
                  <div class="navbar-nav align-items-center">
                    <div class="nav-item d-flex align-items-center">
                      <i class="bx bx-search fs-4 lh-0"></i>
                      <input
                        type="text"
                        class="form-control border-0 shadow-none"
                        placeholder="Search..."
                        aria-label="Search..."
                      />
                    </div>
                  </div>

                  <ul class="navbar-nav flex-row align-items-center ms-auto">
                    <li class="nav-item lh-1 me-3">
                      <a
                        class="github-button"
                        href="https://github.com/themeselection/sneat-html-admin-template-free"
                        data-icon="octicon-star"
                        data-size="large"
                        data-show-count="true"
                        aria-label="Star themeselection/sneat-html-admin-template-free on GitHub"
                      >
                        Star
                      </a>
                    </li>

                    <li class="nav-item navbar-dropdown dropdown-user dropdown">
                      <a
                        class="nav-link dropdown-toggle hide-arrow"
                        href="javascript:void(0);"
                        data-bs-toggle="dropdown"
                      >
                        <div
                          class="avatar avatar-online"
                          onClick={() => handleClickprofile()}
                        >
                          <Image
                            src={require("../assets/img/avatars/1.png")}
                            width={200}
                            height={50}
                            class="w-px-40 h-auto rounded-circle"
                            alt="profile"
                          />
                        </div>
                      </a>
                    </li>
                    {showProfile ? <ProfilOption /> : <></>}
                  </ul>
                </div>
              </nav>
              <main>{<Component {...pageProps} />}</main>
            </div>
          </div>
          <div class="layout-overlay layout-menu-toggle"></div>
        </div>
      </Context>
    </>
  );
}
